import{r as c,j as e,L as f,u as p,S as k,f as x,g as w,T as C,B as z,R as g,a as u,N as P,b as v,c as b}from"./client-DLYV1_1D.js";const S="/Bartosz_Dudziak_Web_Wroclaw/data/products.json",y=c.createContext(void 0);function l(){const t=c.useContext(y);if(t===void 0)throw new Error("CartContext was used outside of CartProvider");return t}function E({product:{id:t,name:s,price:r}}){const{addToCart:n,removeFromCart:a,isInCart:i}=l(),d=()=>{i(t)?a(t):n({id:t,name:s,price:r})};return e.jsxs("li",{className:"product-item",children:[e.jsx("div",{children:s}),e.jsxs("div",{children:[r.main,".",r.fractional," PLN"]}),e.jsx("div",{children:e.jsx("button",{onClick:d,children:i(t)?"Usuń z koszyka":"Dodaj do koszyka"})})]})}function L({products:t}){return e.jsx("ul",{className:"product-list",children:t.map(s=>e.jsx(E,{product:s},s.id))})}function m({children:t,to:s,...r}){return e.jsx(f,{to:s,children:e.jsx("button",{...r,children:t})})}function N(t){const[s,r]=c.useState(null),[n,a]=c.useState(!0),[i,d]=c.useState(null);return c.useEffect(()=>{(async()=>{a(!0);try{const o=await fetch(t);if(!o.ok)throw new Error(`HTTP error! Status: ${o.status}`);const j=await o.json();r(j)}catch(o){d(o instanceof Error?o:new Error("Unknown error"))}finally{a(!1)}})()},[t]),{data:s,isLoading:n,error:i}}function R(){const{items:t=[]}=l(),{getItem:s,removeItem:r}=p("items"),{data:n,isLoading:a,error:i}=N(S);return c.useEffect(()=>{s()&&r()},[t,r,s]),e.jsxs("section",{children:[e.jsx("h1",{children:"Strona Produktów"}),a&&e.jsx("p",{children:"Ładowanie..."}),!a&&i&&e.jsx("p",{children:i.message}),!a&&!i&&(!n||n.length===0)&&e.jsx("p",{children:"Nie znaleziono produktów"}),!a&&!i&&n&&n.length>0&&e.jsx(L,{products:n}),e.jsx(m,{to:"/cart",disabled:t.length===0,children:"Przejdź do koszyka"})]})}function I(){const{setItem:t}=p("items"),{items:s=[]}=l(),r=()=>{t(s),window.location.href="/Bartosz_Dudziak_Web_Wroclaw/confirmation"};return e.jsxs("section",{children:[e.jsx("h1",{children:"Podsumowanie"}),e.jsx(m,{to:"/cart",children:"Wróć do koszyka"}),s.length===0?e.jsx("p",{children:"Nie znaleziono przedmiotów w koszyku"}):e.jsxs(e.Fragment,{children:[e.jsx(k,{items:s}),e.jsx("button",{onClick:r,children:"Złóż zamówienie"})]})]})}function T({id:t,quantity:s}){const{removeFromCart:r,increaseQuantity:n,decreaseQuantity:a}=l(),i=()=>{n(t)},d=()=>{s===1?r(t):a(t)},h=()=>{r(t)};return e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:d,disabled:s===1,children:"➖"}),e.jsx("button",{onClick:i,children:"➕"}),e.jsx("button",{onClick:h,children:"🗑️"})]})}const _=[{header:"Nazwa",accessor:({name:t})=>t,footer:()=>"Razem"},{header:"Cena [PLN]",accessor:({price:t})=>x(+`${t.main}.${t.fractional}`)},{header:"Ilość",accessor:({quantity:t})=>t},{header:"Suma [PLN]",accessor:({quantity:t,price:s})=>x(+x(+`${s.main}.${s.fractional}`)*t),footer:t=>w(t)},{header:"Actions",accessor:({id:t,quantity:s})=>e.jsx(T,{id:t,quantity:s})}];function q(){const{items:t}=l();return e.jsx(C,{data:t,columns:_})}function D(){const{items:t=[]}=l();return e.jsxs("section",{children:[e.jsx("h1",{children:"Koszyk"}),e.jsx(m,{to:"/products",children:"Wróć do listy produktów"}),t.length>0?e.jsxs(e.Fragment,{children:[e.jsx(q,{}),e.jsx(m,{to:"/summary",children:"Przejdź do podsumowania"})]}):e.jsx("p",{children:"Koszyk jest pusty"})]})}function F(){return e.jsxs("section",{children:[e.jsx("h1",{children:"Strona nie istnieje (404)"}),e.jsx(m,{to:"/products",children:"Przejdź do listy produktów"})]})}const W={items:[]};function B(t,s){switch(s.type){case"item/added":{const r={...s.payload.item,quantity:1};return{...t,items:[...t.items,r]}}case"item/removed":{const r=s.payload;return{...t,items:t.items.filter(n=>n.id!==r)}}case"item/quantity/increased":{const r=s.payload;return{...t,items:t.items.map(n=>n.id===r?{...n,quantity:n.quantity++}:n)}}case"item/quantity/decreased":{const r=s.payload;return{...t,items:t.items.map(n=>n.id===r?{...n,quantity:n.quantity--}:n)}}default:throw new Error("Unknown action type")}}function $({children:t}){const[s,r]=c.useReducer(B,W),n=o=>s.items.some(j=>j.id===o),a=o=>{r({type:"item/added",payload:{item:o}})},i=o=>{r({type:"item/removed",payload:o})},d=o=>{r({type:"item/quantity/increased",payload:o})},h=o=>{r({type:"item/quantity/decreased",payload:o})};return e.jsx(y.Provider,{value:{items:s.items,addToCart:a,removeFromCart:i,isInCart:n,increaseQuantity:d,decreaseQuantity:h},children:t})}function A(){return e.jsx($,{children:e.jsx(z,{basename:"/Bartosz_Dudziak_Web_Wroclaw",children:e.jsxs(g,{children:[e.jsxs(u,{path:"/",element:e.jsx(v,{}),children:[e.jsx(u,{index:!0,element:e.jsx(P,{to:"products",replace:!0})}),e.jsx(u,{path:"products",element:e.jsx(R,{})}),e.jsx(u,{path:"summary",element:e.jsx(I,{})}),e.jsx(u,{path:"cart",element:e.jsx(D,{})})]}),e.jsx(u,{path:"*",element:e.jsx(F,{})})]})})})}b.createRoot(document.getElementById("root")).render(e.jsx(c.StrictMode,{children:e.jsx(A,{})}));
