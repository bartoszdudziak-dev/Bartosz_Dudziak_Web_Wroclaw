import{b as p,r as c,j as e,L as k,u as y,S as w,f as x,g as C,T as g,B as P,R as z,a as u,N as v,c as b,d as S}from"./client-C4AihW_Y.js";const E=`${p}/data/products.json`,f=c.createContext(void 0);function l(){const t=c.useContext(f);if(t===void 0)throw new Error("CartContext was used outside of CartProvider");return t}function L({product:{id:t,name:s,price:n}}){const{addToCart:r,removeFromCart:a,isInCart:i}=l(),d=()=>{i(t)?a(t):r({id:t,name:s,price:n})};return e.jsxs("li",{className:"product-item",children:[e.jsx("div",{children:s}),e.jsxs("div",{children:[n.main,".",n.fractional," PLN"]}),e.jsx("div",{children:e.jsx("button",{onClick:d,children:i(t)?"Usuń z koszyka":"Dodaj do koszyka"})})]})}function N({products:t}){return e.jsx("ul",{className:"product-list",children:t.map(s=>e.jsx(L,{product:s},s.id))})}function m({children:t,to:s,...n}){return e.jsx(k,{to:s,children:e.jsx("button",{...n,children:t})})}function R(t){const[s,n]=c.useState(null),[r,a]=c.useState(!0),[i,d]=c.useState(null);return c.useEffect(()=>{(async()=>{a(!0);try{const o=await fetch(t);if(!o.ok)throw new Error(`HTTP error! Status: ${o.status}`);const j=await o.json();n(j)}catch(o){d(o instanceof Error?o:new Error("Unknown error"))}finally{a(!1)}})()},[t]),{data:s,isLoading:r,error:i}}function I(){const{items:t=[]}=l(),{getItem:s,removeItem:n}=y("items"),{data:r,isLoading:a,error:i}=R(E);return c.useEffect(()=>{s()&&n()},[t,n,s]),e.jsxs("section",{children:[e.jsx("h1",{children:"Strona Produktów"}),a&&e.jsx("p",{children:"Ładowanie..."}),!a&&i&&e.jsx("p",{children:i.message}),!a&&!i&&(!r||r.length===0)&&e.jsx("p",{children:"Nie znaleziono produktów"}),!a&&!i&&r&&r.length>0&&e.jsx(N,{products:r}),e.jsx(m,{to:"/cart",disabled:t.length===0,children:"Przejdź do koszyka"})]})}function T(){const{setItem:t}=y("items"),{items:s=[]}=l(),n=()=>{t(s),window.location.href=`${p}/confirmation`};return e.jsxs("section",{children:[e.jsx("h1",{children:"Podsumowanie"}),e.jsx(m,{to:"/cart",children:"Wróć do koszyka"}),s.length===0?e.jsx("p",{children:"Nie znaleziono przedmiotów w koszyku"}):e.jsxs(e.Fragment,{children:[e.jsx(w,{items:s}),e.jsx("button",{onClick:n,children:"Złóż zamówienie"})]})]})}function q({id:t,quantity:s}){const{removeFromCart:n,increaseQuantity:r,decreaseQuantity:a}=l(),i=()=>{r(t)},d=()=>{s===1?n(t):a(t)},h=()=>{n(t)};return e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:d,disabled:s===1,children:"➖"}),e.jsx("button",{onClick:i,children:"➕"}),e.jsx("button",{onClick:h,children:"🗑️"})]})}const F=[{header:"Nazwa",accessor:({name:t})=>t,footer:()=>"Razem"},{header:"Cena [PLN]",accessor:({price:t})=>x(+`${t.main}.${t.fractional}`)},{header:"Ilość",accessor:({quantity:t})=>t},{header:"Suma [PLN]",accessor:({quantity:t,price:s})=>x(+x(+`${s.main}.${s.fractional}`)*t),footer:t=>C(t)},{header:"Actions",accessor:({id:t,quantity:s})=>e.jsx(q,{id:t,quantity:s})}];function $(){const{items:t}=l();return e.jsx(g,{data:t,columns:F})}function D(){const{items:t=[]}=l();return e.jsxs("section",{children:[e.jsx("h1",{children:"Koszyk"}),e.jsx(m,{to:"/products",children:"Wróć do listy produktów"}),t.length>0?e.jsxs(e.Fragment,{children:[e.jsx($,{}),e.jsx(m,{to:"/summary",children:"Przejdź do podsumowania"})]}):e.jsx("p",{children:"Koszyk jest pusty"})]})}function A(){return e.jsxs("section",{children:[e.jsx("h1",{children:"Strona nie istnieje (404)"}),e.jsx(m,{to:"/products",children:"Przejdź do listy produktów"})]})}const B={items:[]};function Q(t,s){switch(s.type){case"item/added":{const n={...s.payload.item,quantity:1};return{...t,items:[...t.items,n]}}case"item/removed":{const n=s.payload;return{...t,items:t.items.filter(r=>r.id!==n)}}case"item/quantity/increased":{const n=s.payload;return{...t,items:t.items.map(r=>r.id===n?{...r,quantity:r.quantity++}:r)}}case"item/quantity/decreased":{const n=s.payload;return{...t,items:t.items.map(r=>r.id===n?{...r,quantity:r.quantity--}:r)}}default:throw new Error("Unknown action type")}}function U({children:t}){const[s,n]=c.useReducer(Q,B),r=o=>s.items.some(j=>j.id===o),a=o=>{n({type:"item/added",payload:{item:o}})},i=o=>{n({type:"item/removed",payload:o})},d=o=>{n({type:"item/quantity/increased",payload:o})},h=o=>{n({type:"item/quantity/decreased",payload:o})};return e.jsx(f.Provider,{value:{items:s.items,addToCart:a,removeFromCart:i,isInCart:r,increaseQuantity:d,decreaseQuantity:h},children:t})}function K(){return e.jsx(U,{children:e.jsx(P,{basename:p,children:e.jsxs(z,{children:[e.jsxs(u,{path:"/",element:e.jsx(b,{}),children:[e.jsx(u,{index:!0,element:e.jsx(v,{to:"products",replace:!0})}),e.jsx(u,{path:"products",element:e.jsx(I,{})}),e.jsx(u,{path:"summary",element:e.jsx(T,{})}),e.jsx(u,{path:"cart",element:e.jsx(D,{})})]}),e.jsx(u,{path:"*",element:e.jsx(A,{})})]})})})}S.createRoot(document.getElementById("root")).render(e.jsx(c.StrictMode,{children:e.jsx(K,{})}));
